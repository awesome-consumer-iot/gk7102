/*!
*****************************************************************************
** \file        e/adi/test/src/tuning.c
**
** \brief       ADI layer tuning test
**
** \attention   THIS SAMPLE CODE IS PROVIDED AS IS. GOKE MICROELECTRONICS
**               ACCEPTS NO RESPONSIBILITY OR LIABILITY FOR ANY ERRORS OR
**               OMMISSIONS
**
** (C) Copyright 2012-2013 by GOKE MICROELECTRONICS CO.,LTD
**
*****************************************************************************
*/
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <ctype.h>
#include <fcntl.h>
#include <unistd.h>
#include <sys/ioctl.h>
#include <sys/types.h>
#include <sys/stat.h>
#include <errno.h>
#include <sys/epoll.h>
#include <getopt.h>


#include "shell.h"
#include "adi_types.h"
#include "adi_sys.h"
#include "adi_isp.h"
#include "tuning.h"


//*****************************************************************************
//*****************************************************************************
//** Local Defines
//*****************************************************************************
//*****************************************************************************

#define ADI_TEST_DEBUG_LEVEL    GADI_SYS_LOG_LEVEL_INFO

//*****************************************************************************
//*****************************************************************************
//** Local structures
//*****************************************************************************
//*****************************************************************************


//*****************************************************************************
//*****************************************************************************
//** Global Data
//*****************************************************************************
//*****************************************************************************
//extern GADI_SYS_HandleT vencHandle;


//*****************************************************************************
//*****************************************************************************
//** Local Data
//*****************************************************************************
//*****************************************************************************
static const char *viShortOptions = "hsp";

static struct option viLongOptions[] =
{
	{"help",	    0, 0, 'h'},
    {"start",       0, 0, 's'},
    {"stop",        0, 0, 'p'},
	{0, 		    0, 0, 0}
};

//*****************************************************************************
//*****************************************************************************
//** Local Functions Declaration
//*****************************************************************************
//*****************************************************************************

static GADI_ERR handle_tuning_command(int argc, char *argv[]);


//*****************************************************************************
//*****************************************************************************
//** API Functions
//*****************************************************************************
//*****************************************************************************
GADI_ERR tuning_register_testcase(void)
{
    GADI_ERR   retVal =  GADI_OK;

	printf("\n");

    (void)shell_registercommand (
        "tuning",
        handle_tuning_command,
        "tuning command",
        "---------------------------------------------------------------------\n"
        "tuning -S \n"
        "   brief : tuning server start.\n"
        "\n"
        "---------------------------------------------------------------------\n"
        "tuning -P \n"
        "   brief : tuning server stop.\n"
        "\n"
        /******************************************************************/
    );

    return retVal;
}

static void tuning_usage(void)
{
    printf("\nusage: tuning [OPTION]...\n");
    printf("\t-h, --help              help.\n"
           "\t-s, --start             start tuning server\n"
           "\t-p, --stop              stop tuning server\n"
          );
	printf("\n");
}

static GADI_ERR handle_tuning_command(int argc, char *argv[])
{
    int option_index, ch;
	int retVal;

	optind = 1;

    /*change parameters when giving input options.*/
    while ((ch = getopt_long(argc, argv, viShortOptions, viLongOptions, &option_index)) != -1)
    {
        switch (ch)
        {
            ////////////////////////////////////////////////////////////////////////
            ////////////////////////////////////////////////////////////////////////
            case 'h':
            {
                tuning_usage();
                break;
            }
            ////////////////////////////////////////////////////////////////////////
            ////////////////////////////////////////////////////////////////////////
            case 's':
            {
                retVal = gadi_isp_tuning_start();
                if (retVal != GADI_OK)
                {
                    goto bad_parameter;
                }
                break;
            }
            ////////////////////////////////////////////////////////////////////////
            ////////////////////////////////////////////////////////////////////////
            case 'p':
            {
                retVal = gadi_isp_tuning_stop();
                if (retVal != GADI_OK)
                {
                    goto bad_parameter;
                }
                break;
            }
            ////////////////////////////////////////////////////////////////////////
            ////////////////////////////////////////////////////////////////////////
            default:
                GADI_ERROR("bad params\n");
                break;
        }
    }
    optind = 1;
    return 0;

bad_parameter:
    optind = 1;
    return -1;
}




//*****************************************************************************
//*****************************************************************************
//** Local Functions
//*****************************************************************************
//*****************************************************************************




